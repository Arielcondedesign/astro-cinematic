---
import { Image } from 'astro:assets';
import missionImage1 from '../../assets/masque-portrait.webp';
import missionImage2 from '../../assets/africa-bayon-scenographe.webp';
import missionImage3 from '../../assets/lidia-martin-merino-directrice-documentaire.webp';

interface Props {
  class?: string;
}

const { class: className } = Astro.props;

// Array of images for the carousel
const images = [
  { src: missionImage1, alt: "Portrait avec masque - La Jetée Films" },
  { src: missionImage2, alt: "Africa Bayon - La Jetée Films" },
  { src: missionImage3, alt: "Lidia Martín Merino - La Jetée Films" },
];
---

<div class="relative w-full" x-data="{ activeSlide: 0 }" x-init="setInterval(() => { activeSlide = (activeSlide + 1) % 3 }, 5000)">
  <!-- Carousel container -->
  <div class="relative overflow-hidden rounded-3xl aspect-[3/4]">
    {images.map((image, index) => (
      <div
        x-show={`activeSlide === ${index}`}
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 transform translate-x-full"
        x-transition:enter-end="opacity-100 transform translate-x-0"
        x-transition:leave="transition ease-in duration-300"
        x-transition:leave-start="opacity-100 transform translate-x-0"
        x-transition:leave-end="opacity-0 transform -translate-x-full"
        class="absolute inset-0"
      >
        <Image
          src={image.src}
          alt={image.alt}
          width={576}
          height={768}
          class={`w-full h-full object-cover ${className}`}
          loading="lazy"
          decoding="async"
        />
      </div>
    ))}
  </div>

  <!-- Navigation dots -->
  <div class="absolute inset-x-0 bottom-4 flex justify-center space-x-2">
    {images.map((_, index) => (
      <button
        type="button"
        x-on:click={`activeSlide = ${index}`}
        x-bind:class={`activeSlide === ${index} ? 'bg-white' : 'bg-white/50'`}
        class="w-2 h-2 rounded-full transition-colors duration-200 focus:outline-none"
        aria-label={`Go to slide ${index + 1}`}
      >
      </button>
    ))}
  </div>

  <!-- Previous/Next Buttons -->
  <button
    x-on:click="activeSlide = (activeSlide - 1 + 3) % 3"
    class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/30 hover:bg-white/50 rounded-full p-2 backdrop-blur-sm transition-colors duration-200"
    aria-label="Previous slide"
  >
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
    </svg>
  </button>
  <button
    x-on:click="activeSlide = (activeSlide + 1) % 3"
    class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/30 hover:bg-white/50 rounded-full p-2 backdrop-blur-sm transition-colors duration-200"
    aria-label="Next slide"
  >
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
    </svg>
  </button>
</div>